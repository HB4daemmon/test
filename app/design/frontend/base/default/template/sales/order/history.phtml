<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     base_default
 * @copyright   Copyright (c) 2013 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>
<?php echo $this->getMessagesBlock()->getGroupedHtml() ?>
<?php $_orders = $this->getOrders(); ?>
<div class="page-title">
    <h1><?php echo $this->__('My Orders') ?></h1>
</div>
<?php echo $this->getPagerHtml(); ?>
<?php if($_orders->getSize()): ?>

<script>
    jQuery(function () {
        (function() {
            var isBootstrapEvent = false;
            if (window.jQuery) {
                var all = jQuery('*');
                jQuery.each(['hide.bs.dropdown',
                    'hide.bs.collapse',
                    'hide.bs.modal',
                    'hide.bs.tooltip',
                    'hide.bs.popover'], function(index, eventName) {
                    all.on(eventName, function( event ) {
                        isBootstrapEvent = true;
                    });
                });
            }
            var originalHide = Element.hide;
            Element.addMethods({
                hide: function(element) {
                    if(isBootstrapEvent) {
                        isBootstrapEvent = false;
                        return element;
                    }
                    return originalHide(element);
                }
            });
        })();
        jQuery('[data-toggle="popover"]').popover();
    })
</script>

<style>
    .pop{
        padding: 2px;background-color: #65c178;color:white;border-radius: 5px;cursor: pointer;
    }

    .icon{
        width: 88px;
        vertical-align: top
    }

    .svg{
        margin: 10px;
    }

    .line{
        display: inline-block;
        text-align:center;
        height: 158px;
        margin:0 auto;
    }

    .green{
        color:#65c178 !important;
    }

    .orange{
        color:#ffa200 !important;
    }

    .grey{
        color:#bababa !important;
    }

    .unwrap{
        width: 120px;
        margin-left: -18px;
    }

    .icon div span{
        font-weight: bold;
    }

    .line hr{
        margin-top: 65px;
    }

    .popover{
        width:800px;
        max-width: none;
        margin-left: -62px;
        border: 1px solid #65c178;
        z-index: 0;
    }

    .popover.bottom .arrow{
        left:58%;
        border-bottom-color: #65c178;
    }

    .popover-content{

    }
</style>

<table class="data-table" id="my-orders-table">
    <col width="1" />
    <col width="1" />
    <col width="1"  />
    <col width="1" />
    <col width="1" />
    <thead>
        <tr>
            <th><?php echo $this->__('Order #') ?></th>
            <th><?php echo $this->__('ORDER DATE') ?></th>
<!--            <th>--><?php //echo $this->__('Ship To') ?><!--</th>-->
            <th><span class="nobr"><?php echo $this->__('TOTAL') ?></span></th>
            <th><span class="nobr"><?php echo $this->__('STATUS') ?></span></th>
            <th>&nbsp;</th>
        </tr>
    </thead>
    <tbody>
        <?php $_odd = ''; ?>
        <?php foreach ($_orders as $_order): ?>
        <?php $status = $this->getHistoryStatus($_order);?>
        <tr>
            <td><?php echo $_order->getRealOrderId() ?></td>
<!--            <td><span class="nobr">--><?php //echo $this->formatDate($_order->getCreatedAtStoreDate()) ?><!--</span></td>-->
            <td><span class="nobr"><?php echo $this->getStandDataFormat($_order->getCreatedAtStoreDate()) ?></span></td>
<!--            <td>--><?php //echo $_order->getShippingAddress() ? $this->escapeHtml($_order->getShippingAddress()->getName()) : '&nbsp;' ?><!--</td>-->
            <td><?php echo $_order->formatPrice($_order->getGrandTotal()) ?></td>
            <td><em><?php echo $_order->getStatusLabel() ?></em><p>
                <div class="pop" data-container="body" data-toggle="popover" data-placement="bottom" data-content='
                <div style="margin-top: 25px;display: inline-block;width:800px">
    <div class="line">
        <hr style=" height:2px;border:none;border-top:2px solid ;width: 44px" class="<?php echo $status['complete'][2];?>"/>
    </div>
    <div class="line icon <?php echo $status["complete"][2];?>">
        <div><span>Pending</span></div>
        <embed src="<?php echo $this->getSkinUrl("cartgogogo/images/1-".$status['complete'][3]."pending.svg") ?>" width="68" height="68"
               type="image/svg+xml" class="svg"
               pluginspage="http://www.adobe.com/svg/viewer/install/" />
        <div><?php echo $status["complete"][0];?></div>
        <div class="unwrap"><?php echo $status["complete"][1];?></div>
    </div>
    <div class="line">
        <hr style=" height:2px;border:none;border-top:2px solid ;width: 50px" class="<?php echo $status["confirmed"][2];?>">
    </div>
    <div class="line icon <?php echo $status["confirmed"][2];?>">
        <div><span>Confirmed</span></div>
        <embed src="<?php echo $this->getSkinUrl("cartgogogo/images/2-".$status["confirmed"][3]."confirmed.svg") ?>" width="68" height="68"
               type="image/svg+xml" class="svg"
               pluginspage="http://www.adobe.com/svg/viewer/install/" />
        <div><?php echo $status["confirmed"][0];?></div>
        <div class="unwrap"><?php echo $status["confirmed"][1];?></div>
    </div>
    <div class="line">
        <hr style=" height:2px;border:none;border-top:2px solid ;width: 50px" class="<?php echo $status["in_progress"][2];?>"/>
    </div>
    <div class="line icon <?php echo $status["in_progress"][2];?>">
        <div><span>In Progress</span></div>
        <embed src="<?php echo $this->getSkinUrl("cartgogogo/images/3-".$status["in_progress"][3]."in progress.svg") ?>" width="68" height="68"
               type="image/svg+xml" class="svg"
               pluginspage="http://www.adobe.com/svg/viewer/install/" />
        <div><?php echo $status["in_progress"][0];?></div>
        <div class="unwrap"><?php echo $status["in_progress"][1];?></div>
    </div>
    <div class="line">
        <hr style=" height:2px;border:none;border-top:2px solid ;width: 50px" class="<?php echo $status["in_transit"][2];?>"/>
    </div>
    <div class="line icon <?php echo $status["in_transit"][2];?>">
        <div><span>In Transit</span></div>
        <embed src="<?php echo $this->getSkinUrl("cartgogogo/images/4-".$status["in_transit"][3]."in transit.svg") ?>" width="68" height="68"
               type="image/svg+xml" class="svg"
               pluginspage="http://www.adobe.com/svg/viewer/install/" />
        <div><?php echo $status["in_transit"][0];?></div>
        <div class="unwrap"><?php echo $status["in_transit"][1];?></div>
    </div>
    <div class="line">
        <hr style=" height:2px;border:none;border-top:2px solid ;width: 50px" class="<?php echo $status["in_transit"][2];?>"/>
    </div>
    <div class="line icon <?php echo $status["delivered"][2];?>">
        <div><span>Delivered</span></div>
        <embed src="<?php echo $this->getSkinUrl("cartgogogo/images/5-".$status["delivered"][3]."delivered.svg") ?>" width="68" height="68"
               type="image/svg+xml" class="svg"
               pluginspage="http://www.adobe.com/svg/viewer/install/" />
        <div><?php echo $status["delivered"][0];?></div>
        <div class="unwrap"><?php echo $status["delivered"][1];?></div>
    </div>
    <div class="line <?php echo $status["delivered"][2];?>" style="vertical-align: top;margin-top: 33px;">
        <embed src="<?php echo $this->getSkinUrl("cartgogogo/images/6-".$status["delivered"][3]."arrow.svg") ?>" width="44" height="44"
               type="image/svg+xml" class="svg"
               pluginspage="http://www.adobe.com/svg/viewer/install/" />
    </div>
</div>' data-html="true">View Tracking</div>
                </p></td>
            <td class="a-center">
                <span class="nobr"><a href="<?php echo $this->getViewUrl($_order) ?>"><?php echo $this->__('View Order') ?></a>
                    <?php /*<span class="separator">|</span><a href="<?php echo $this->getTrackUrl($_order) ?>"><?php echo $this->__('Track Order') ?></a>&nbsp;*/ ?>
                    <?php if ($this->helper('sales/reorder')->canReorder($_order)) : ?>
                    <span class="separator">|</span> <a href="<?php echo $this->getReorderUrl($_order) ?>" class="link-reorder"><?php echo $this->__('Reorder') ?></a>
                <?php endif ?>
                </span>
            </td>
        </tr>
        <?php endforeach; ?>
    </tbody>
</table>
<script type="text/javascript">decorateTable('my-orders-table');</script>
<?php echo $this->getPagerHtml(); ?>
<?php else: ?>
    <p><?php echo $this->__('You have placed no orders.'); ?></p>
<?php endif ?>
